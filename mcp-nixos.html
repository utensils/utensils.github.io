<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><title data-next-head="">MCP-NixOS | Utensils</title><meta property="og:title" content="MCP-NixOS | Utensils.io" data-next-head=""/><meta property="og:description" content="Model Context Protocol Server for NixOS resources" data-next-head=""/><meta property="og:image" content="https://utensils.io/images/pages/mcp-nixos/social-share.png" data-next-head=""/><meta property="og:url" content="https://utensils.io/mcp-nixos" data-next-head=""/><meta property="og:type" content="article" data-next-head=""/><meta property="og:site_name" content="Utensils.io" data-next-head=""/><meta name="twitter:card" content="summary_large_image" data-next-head=""/><meta name="twitter:title" content="MCP-NixOS | Utensils.io" data-next-head=""/><meta name="twitter:description" content="Model Context Protocol Server for NixOS resources" data-next-head=""/><meta name="twitter:image" content="https://utensils.io/images/pages/mcp-nixos/social-share.png" data-next-head=""/><link rel="apple-touch-icon" sizes="180x180" href="/images/pages/mcp-nixos/favicon/apple-touch-icon.png" data-next-head=""/><link rel="apple-touch-icon-precomposed" href="/images/pages/mcp-nixos/favicon/apple-touch-icon-precomposed.png" data-next-head=""/><link rel="icon" type="image/png" sizes="32x32" href="/images/pages/mcp-nixos/favicon/favicon-32x32.png" data-next-head=""/><link rel="icon" type="image/png" sizes="16x16" href="/images/pages/mcp-nixos/favicon/favicon-16x16.png" data-next-head=""/><link rel="shortcut icon" href="/images/pages/mcp-nixos/favicon/favicon.ico" data-next-head=""/><meta name="msapplication-TileColor" content="#000000" data-next-head=""/><meta name="theme-color" content="#000" data-next-head=""/><link rel="alternate" type="application/rss+xml" href="/feed.xml" data-next-head=""/><meta name="description" content="Model Context Protocol Server for NixOS resources" data-next-head=""/><link rel="preload" href="/_next/static/css/ee2fbefe6c76a6d1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/ee2fbefe6c76a6d1.css" data-n-g=""/><link rel="preload" href="/_next/static/css/fd10aaedcf85d48c.css" as="style"/><link rel="stylesheet" href="/_next/static/css/fd10aaedcf85d48c.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="/_next/static/chunks/webpack-8cac0b4b405cede1.js" defer=""></script><script src="/_next/static/chunks/framework-ee17a4c43a44d3e2.js" defer=""></script><script src="/_next/static/chunks/main-99fa197f23f793be.js" defer=""></script><script src="/_next/static/chunks/pages/_app-4fb6a1a458821650.js" defer=""></script><script src="/_next/static/chunks/695-4568df259c13997f.js" defer=""></script><script src="/_next/static/chunks/pages/%5Bpage%5D-d4790178e458a355.js" defer=""></script><script src="/_next/static/Um1-lr3K4IXIJU3rT7vNx/_buildManifest.js" defer=""></script><script src="/_next/static/Um1-lr3K4IXIJU3rT7vNx/_ssgManifest.js" defer=""></script></head><body><div id="__next"><div class="min-h-screen"><main><div class="container ml-0 mr-auto px-5 overflow-x-hidden"><section class="flex-col flex items-left mt-20"><div class="flex-row flex items-left text-left"><a class="flex title-font font-medium items-center md:justify-start justify-center mr-4" href="/"><img src="/logo.png" class="w-12 h-12 mb-2"/></a><a href="/articles" class="pt-1 text-3xl text-red-500 hover:text-red-600 font-black hover:underline mr-4">Articles</a><a href="https://github.com/utensils" target="_blank" class="pt-1 text-3xl text-red-500 hover:text-red-600 font-black hover:underline">GitHub</a></div><div class="flex-col flex items-left mt-10"><h1 class="text-8xl font-black tracking-tighter leading-tight md:pr-8">Utensils</h1><span class="lowercase text-4xl text-gray-400">MCP-NixOS</span></div></section><article><div class="max-w-full md:max-w-3xl lg:max-w-4xl xl:max-w-5xl ml-0 mr-auto pl-3 md:pl-6 pt-6"><div class="text-base sm:text-lg text-gray-500 mb-6">Because Your AI Assistant Should Not Hallucinate About Packages</div></div><div class="max-w-full md:max-w-3xl lg:max-w-4xl xl:max-w-5xl ml-0 mr-auto pl-3 md:pl-6 overflow-x-hidden"><div class="markdown-styles_markdown__HwUWZ text-base sm:text-lg"><h1>MCP-NixOS - Because Your AI Assistant Shouldn't Hallucinate About Packages</h1>
<h2>What The Hell Is This Thing?</h2>
<p>MCP-NixOS is a Model Context Protocol server that stops your AI assistant from making stuff up about NixOS. Because let's face it—the only thing worse than confusing NixOS documentation is an AI confidently hallucinating about it.</p>
<p>It provides real-time access to:</p>
<ul>
<li>NixOS packages (yes, the ones that actually exist)</li>
<li>System options (the ones you'll spend hours configuring)</li>
<li>Home Manager settings (for when system-wide chaos isn't enough)</li>
<li>nix-darwin macOS configurations (because Apple users need complexity too)</li>
</ul>
<h2>Quick Start: For the Chronically Impatient</h2>
<p>Look, we both know you're just going to skim this README and then complain when things don't work. Here's the bare minimum to get started:</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"mcpServers"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"nixos"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"command"</span><span class="token operator">:</span> <span class="token string">"uvx"</span><span class="token punctuation">,</span>
      <span class="token property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"mcp-nixos"</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>There. Now your AI assistant can actually give you correct information about NixOS instead of hallucinating package names from 2019. You're welcome.</p>
<h3>Environment Variables (For Control Freaks)</h3>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>MCP_NIXOS_LOG_LEVEL</code></td>
<td>How much you want to know about your failures</td>
<td>INFO</td>
</tr>
<tr>
<td><code>MCP_NIXOS_LOG_FILE</code></td>
<td>Where to document said failures</td>
<td>(nowhere—your secret is safe)</td>
</tr>
<tr>
<td><code>MCP_NIXOS_CACHE_DIR</code></td>
<td>Where to store stuff you'll forget about</td>
<td>OS-specific cache locations*</td>
</tr>
<tr>
<td><code>MCP_NIXOS_CACHE_TTL</code></td>
<td>How long until cache invalidation ruins your day</td>
<td>86400 (24h)</td>
</tr>
<tr>
<td><code>MCP_NIXOS_CLEANUP_ORPHANS</code></td>
<td>Whether to kill orphaned MCP processes on startup</td>
<td>false</td>
</tr>
<tr>
<td><code>KEEP_TEST_CACHE</code></td>
<td>Keep test cache directory for debugging (dev-only)</td>
<td>false</td>
</tr>
<tr>
<td><code>ELASTICSEARCH_URL</code></td>
<td>NixOS Elasticsearch API URL</td>
<td><a href="https://search.nixos.org/backend">https://search.nixos.org/backend</a></td>
</tr>
</tbody>
</table>
<p>*Default cache locations (where your gigabytes will quietly disappear to):</p>
<ul>
<li>Linux: <code>~/.cache/mcp_nixos/</code> (because ~/.cache wasn't cluttered enough)</li>
<li>macOS: <code>~/Library/Caches/mcp_nixos/</code> (buried where you'll never look)</li>
<li>Windows: <code>%LOCALAPPDATA%\mcp_nixos\Cache\</code> (lost in the void of Windows directories)</li>
</ul>
<h2>Features That Might Actually Work</h2>
<ul>
<li><strong>NixOS Resources</strong>: Packages and system options via Elasticsearch API
<ul>
<li>Multiple channels: unstable (for the brave), stable (for the boring), and specific versions</li>
<li>Detailed package metadata that tells you everything except how to make it work</li>
</ul>
</li>
<li><strong>Home Manager</strong>: User configuration options via parsed documentation
<ul>
<li>Programs, services, and settings you'll spend weekends configuring</li>
<li>Hierarchical paths for when you want to get absurdly specific</li>
</ul>
</li>
<li><strong>nix-darwin</strong>: macOS configuration for the "I use NixOS BTW" Apple users
<ul>
<li>System defaults, services, and settings Apple never intended you to touch</li>
<li>Break your Mac in new and exciting ways!</li>
</ul>
</li>
<li><strong>Smart Caching</strong>: Because nobody wants to wait for Elasticsearch queries
<ul>
<li>Reduces network requests and improves startup time</li>
<li>Works offline once cached (perfect for your next internet outage)</li>
</ul>
</li>
<li><strong>Rich Search</strong>: Find what you need or something close enough
<ul>
<li>Fast in-memory search engine that's surprisingly not terrible</li>
<li>Related options for when you're not quite sure what you're looking for</li>
</ul>
</li>
</ul>
<h2>MCP Resources &#x26; Tools: The Power Tools You Didn't Know You Needed</h2>
<h3>NixOS: The OS That Makes You Feel Simultaneously Smarter and Dumber</h3>
<p><strong>Resources:</strong></p>
<ul>
<li><code>nixos://package/{name}</code> - Find that package you're sure exists</li>
<li><code>nixos://search/packages/{query}</code> - Search for packages that might exist</li>
<li><code>nixos://search/options/{query}</code> - Search system options you'll misconfig</li>
<li><code>nixos://option/{name}</code> - Get option info you'll still manage to mess up</li>
<li><code>nixos://search/programs/{name}</code> - Find packages providing programs</li>
<li><code>nixos://packages/stats</code> - Stats to impress your nerd friends</li>
</ul>
<p><strong>Tools:</strong></p>
<ul>
<li><code>nixos_search(query, type, channel)</code> - The search function you'll use most</li>
<li><code>nixos_info(name, type, channel)</code> - Get package or option details</li>
<li><code>nixos_stats(channel)</code> - Get NixOS statistics nobody asked for</li>
</ul>
<p><strong>Channels:</strong></p>
<ul>
<li><code>unstable</code> (default) - Living on the edge where nothing is stable, including your sanity</li>
<li><code>stable</code> (24.11) - For those who prefer their breakage on a schedule</li>
<li>Old versions - For when you're feeling nostalgic about earlier failures</li>
</ul>
<h3>Home Manager: Because System-Wide Configuration Wasn't Complicated Enough</h3>
<p><strong>Resources:</strong></p>
<ul>
<li><code>home-manager://search/options/{query}</code> - Search user config options</li>
<li><code>home-manager://option/{name}</code> - Option details you'll screenshot for later</li>
<li><code>home-manager://options/prefix/{prefix}</code> - All options under a prefix</li>
<li><code>home-manager://options/{category}</code> - Category options (programs, services, etc.)</li>
</ul>
<p><strong>Tools:</strong></p>
<ul>
<li><code>home_manager_search(query)</code> - Search configuration options</li>
<li><code>home_manager_info(name)</code> - Get option details with actual explanation</li>
<li><code>home_manager_options_by_prefix(option_prefix)</code> - Get options by prefix</li>
<li><code>home_manager_list_options()</code> - List all option categories when overwhelmed</li>
</ul>
<h3>nix-darwin: For Mac Users Who Crave Pain</h3>
<p><strong>Resources:</strong></p>
<ul>
<li><code>darwin://search/options/{query}</code> - Search macOS options</li>
<li><code>darwin://option/{name}</code> - Option details for your Apple devices</li>
<li><code>darwin://options/prefix/{prefix}</code> - All options under a prefix</li>
<li><code>darwin://options/{category}</code> - Category options (system, services, etc.)</li>
</ul>
<p><strong>Tools:</strong></p>
<ul>
<li><code>darwin_search(query)</code> - Search macOS configuration options</li>
<li><code>darwin_info(name)</code> - Get option details Apple doesn't want you to know</li>
<li><code>darwin_options_by_prefix(option_prefix)</code> - Get options by prefix</li>
<li><code>darwin_list_options()</code> - List all option categories</li>
</ul>
<h3>Tool Usage Examples (Copy/Paste Ready)</h3>
<pre class="language-python"><code class="language-python"><span class="token comment"># NixOS examples for when you're pretending to know what you're doing</span>
nixos_search<span class="token punctuation">(</span>query<span class="token operator">=</span><span class="token string">"firefox"</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"packages"</span><span class="token punctuation">,</span> channel<span class="token operator">=</span><span class="token string">"unstable"</span><span class="token punctuation">)</span>
nixos_search<span class="token punctuation">(</span>query<span class="token operator">=</span><span class="token string">"postgresql"</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"options"</span><span class="token punctuation">,</span> channel<span class="token operator">=</span><span class="token string">"stable"</span><span class="token punctuation">)</span>
nixos_info<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"firefox"</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"package"</span><span class="token punctuation">)</span>
nixos_info<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"services.postgresql.enable"</span><span class="token punctuation">,</span> <span class="token builtin">type</span><span class="token operator">=</span><span class="token string">"option"</span><span class="token punctuation">)</span>

<span class="token comment"># Home Manager examples for the domestic configuration enthusiasts</span>
home_manager_search<span class="token punctuation">(</span>query<span class="token operator">=</span><span class="token string">"programs.git"</span><span class="token punctuation">)</span>
home_manager_info<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"programs.firefox.enable"</span><span class="token punctuation">)</span>
home_manager_options_by_prefix<span class="token punctuation">(</span>option_prefix<span class="token operator">=</span><span class="token string">"programs.git"</span><span class="token punctuation">)</span>

<span class="token comment"># nix-darwin examples for the masochistic Mac users</span>
darwin_search<span class="token punctuation">(</span>query<span class="token operator">=</span><span class="token string">"system.defaults.dock"</span><span class="token punctuation">)</span>
darwin_info<span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"services.yabai.enable"</span><span class="token punctuation">)</span>
darwin_options_by_prefix<span class="token punctuation">(</span>option_prefix<span class="token operator">=</span><span class="token string">"system.defaults"</span><span class="token punctuation">)</span></code></pre>
<h2>Installation &#x26; Configuration: The Part You'll Probably Skip</h2>
<h3>Install It (Pick Your Poison)</h3>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># Option 1: Install with pip like a normie</span>
pip <span class="token function">install</span> mcp-nixos

<span class="token comment"># Option 2: Install with uv because you're too cool for pip</span>
uv pip <span class="token function">install</span> mcp-nixos

<span class="token comment"># Option 3: Run directly with uvx (recommended for the truly enlightened)</span>
uvx --install-deps mcp-nixos</code></pre>
<h3>Configure It (The Part You'll Definitely Mess Up)</h3>
<p>Add to your MCP configuration file (e.g., <code>~/.config/claude/config.json</code>):</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"mcpServers"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"nixos"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"command"</span><span class="token operator">:</span> <span class="token string">"uvx"</span><span class="token punctuation">,</span>
      <span class="token property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"mcp-nixos"</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>For development with the source code (for those who enjoy punishment):</p>
<pre class="language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"mcpServers"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"nixos"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"command"</span><span class="token operator">:</span> <span class="token string">"uv"</span><span class="token punctuation">,</span>
      <span class="token property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"run"</span><span class="token punctuation">,</span> <span class="token string">"-m"</span><span class="token punctuation">,</span> <span class="token string">"mcp_nixos.__main__"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token property">"env"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"PYTHONPATH"</span><span class="token operator">:</span> <span class="token string">"."</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<h3>Cache &#x26; Channels: Where Magic Happens and Files Disappear</h3>
<p><strong>Cache System:</strong></p>
<ul>
<li>Default locations that you'll forget about in 5 minutes</li>
<li>Stores HTML content, serialized data, and search indices</li>
<li>Works offline once cached (the only feature you'll actually appreciate)</li>
</ul>
<p><strong>NixOS Channels:</strong></p>
<ul>
<li><code>unstable</code>: Latest NixOS unstable (for daredevils)</li>
<li><code>stable</code>: Current stable release (for the risk-averse)</li>
<li><code>24.11</code>: Specific version reference (for the historically inclined)</li>
</ul>
<h2>Development: For Those Not Content With Just Using Things</h2>
<h3>Dependencies (Because Nothing Stands Alone Anymore)</h3>
<p>This project uses <code>pyproject.toml</code> because we're not animals.</p>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># Install development dependencies for the brave</span>
pip <span class="token function">install</span> <span class="token parameter variable">-e</span> <span class="token string">".[dev]"</span>

<span class="token comment"># Or with uv (recommended for the enlightened)</span>
uv pip <span class="token function">install</span> <span class="token parameter variable">-e</span> <span class="token string">".[dev]"</span></code></pre>
<h3>Using Nix (Of Course There's a Nix Development Environment)</h3>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># Enter dev shell and see available commands</span>
nix develop <span class="token operator">&amp;&amp;</span> menu

<span class="token comment"># Common commands for common folk</span>
run         <span class="token comment"># Start the server (and your journey into madness)</span>
run-tests   <span class="token comment"># Run tests with coverage (expose the flaws)</span>
lint        <span class="token comment"># Format and lint code (fix the mess you made)</span>
publish     <span class="token comment"># Build and publish to PyPI (share your pain)</span></code></pre>
<h3>Testing (Yes, We Actually Do That)</h3>
<p>Tests use real Elasticsearch API calls instead of mocks because we're not afraid of the real world:</p>
<pre class="language-bash"><code class="language-bash"><span class="token comment"># Run tests with coverage (default and recommended)</span>
run-tests

<span class="token comment"># Run tests without coverage (for those who prefer blissful ignorance)</span>
run-tests --no-coverage</code></pre>
<p>Code coverage is tracked on <a href="https://codecov.io/gh/utensils/mcp-nixos">Codecov</a> (where we pretend to care about 100% coverage).</p>
<h2>Using with LLMs: The Whole Point of This Exercise</h2>
<p>Once configured, use MCP-NixOS in your prompts with MCP-compatible models:</p>
<pre><code># NixOS resources for the confused
~nixos://package/python
~nixos://option/services.nginx
~nixos://search/packages/firefox

# Home Manager resources for the domestically challenged
~home-manager://search/options/programs.git
~home-manager://option/programs.firefox.profiles

# nix-darwin resources for the Apple addicted
~darwin://search/options/system.defaults.dock

# NixOS tools for the tool-inclined
~nixos_search(query="postgresql", type="options")
~nixos_info(name="firefox", type="package", channel="unstable")

# Home Manager tools for home improvement
~home_manager_search(query="programs.zsh")
~home_manager_info(name="programs.git.userName")

# nix-darwin tools for the Mac masochists
~darwin_search(query="services.yabai")
~darwin_info(name="system.defaults.dock.autohide")
</code></pre>
<p>The LLM will fetch information through the MCP server and might actually give you correct information for once.</p>
<h2>Implementation Details: The House of Cards Revealed</h2>
<h3>Code Architecture: How We Made This Work (Somehow)</h3>
<p>MCP-NixOS is organized into a modular structure that somehow manages to work despite all odds:</p>
<ul>
<li><code>mcp_nixos/cache/</code> - Caching components that save your bandwidth and sanity</li>
<li><code>mcp_nixos/clients/</code> - API clients that talk to Elasticsearch and parse HTML docs</li>
<li><code>mcp_nixos/contexts/</code> - Context objects that keep everything from falling apart</li>
<li><code>mcp_nixos/resources/</code> - MCP resource definitions for all platforms</li>
<li><code>mcp_nixos/tools/</code> - MCP tool implementations that do the actual work</li>
<li><code>mcp_nixos/utils/</code> - Utility functions because we're not animals</li>
<li><code>mcp_nixos/server.py</code> - The glue that holds this house of cards together</li>
</ul>
<h3>NixOS API Integration: The External Connection</h3>
<p>Connects to the NixOS Elasticsearch API with:</p>
<ul>
<li>Multiple channel support (unstable, stable/24.11)</li>
<li>Field-specific search boosts for better relevance</li>
<li>Error handling that expects the worst but hopes for the best (story of my life)</li>
</ul>
<h3>HTML Documentation Parsers: Where Dreams Go To Die</h3>
<p>For Home Manager and nix-darwin options, we've committed crimes against HTML parsing:</p>
<ol>
<li>
<p><strong>Documentation Parsers</strong>: Extracts structured data through a combination of BeautifulSoup incantations, regex black magic, and the kind of determination that only comes from staring at malformed HTML for 72 hours straight.</p>
</li>
<li>
<p><strong>Search Engines</strong>: Cobbled together with:</p>
<ul>
<li>Inverted index for fast text search (when it doesn't fall over)</li>
<li>Prefix tree for hierarchical lookups (seemed like a good idea at 3 AM)</li>
<li>Result scoring based on an algorithm best described as "vibes-based sorting"</li>
</ul>
</li>
<li>
<p><strong>Caching System</strong>: Because parsing that HTML once was traumatic enough:</p>
<ul>
<li>Stores HTML content, processed data structures, and search indices</li>
<li>Uses platform-specific cache locations so you don't have to think about it</li>
<li>Implements TTL-based expiration to refresh content when needed</li>
<li>Falls back gracefully when things inevitably go wrong (unlike my relationships)</li>
</ul>
</li>
</ol>
<h2>What is Model Context Protocol?</h2>
<h3>For Those Who Skipped Straight to the End</h3>
<p>The <a href="https://modelcontextprotocol.io">Model Context Protocol (MCP)</a> is an open protocol that connects LLMs to external data and tools using JSON messages over stdin/stdout. This project implements MCP to give AI assistants access to NixOS, Home Manager, and nix-darwin resources, so they can finally stop making things up about your operating system.</p>
<h2>License</h2>
<p>MIT (Because I'm not a monster)</p>
<hr>
<p><em>Created by James Brink, self-proclaimed Tinkerer of Terror, who somehow manages to make things work despite himself.</em></p>
</div></div></article></div></main></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"page":{"title":"MCP-NixOS","description":"Model Context Protocol Server for NixOS resources","excerpt":"Because Your AI Assistant Should Not Hallucinate About Packages","content":"\u003ch1\u003eMCP-NixOS - Because Your AI Assistant Shouldn't Hallucinate About Packages\u003c/h1\u003e\n\u003ch2\u003eWhat The Hell Is This Thing?\u003c/h2\u003e\n\u003cp\u003eMCP-NixOS is a Model Context Protocol server that stops your AI assistant from making stuff up about NixOS. Because let's face it—the only thing worse than confusing NixOS documentation is an AI confidently hallucinating about it.\u003c/p\u003e\n\u003cp\u003eIt provides real-time access to:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eNixOS packages (yes, the ones that actually exist)\u003c/li\u003e\n\u003cli\u003eSystem options (the ones you'll spend hours configuring)\u003c/li\u003e\n\u003cli\u003eHome Manager settings (for when system-wide chaos isn't enough)\u003c/li\u003e\n\u003cli\u003enix-darwin macOS configurations (because Apple users need complexity too)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eQuick Start: For the Chronically Impatient\u003c/h2\u003e\n\u003cp\u003eLook, we both know you're just going to skim this README and then complain when things don't work. Here's the bare minimum to get started:\u003c/p\u003e\n\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"mcpServers\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"nixos\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"command\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"uvx\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"args\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"mcp-nixos\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThere. Now your AI assistant can actually give you correct information about NixOS instead of hallucinating package names from 2019. You're welcome.\u003c/p\u003e\n\u003ch3\u003eEnvironment Variables (For Control Freaks)\u003c/h3\u003e\n\u003ctable\u003e\n\u003cthead\u003e\n\u003ctr\u003e\n\u003cth\u003eVariable\u003c/th\u003e\n\u003cth\u003eDescription\u003c/th\u003e\n\u003cth\u003eDefault\u003c/th\u003e\n\u003c/tr\u003e\n\u003c/thead\u003e\n\u003ctbody\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eMCP_NIXOS_LOG_LEVEL\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eHow much you want to know about your failures\u003c/td\u003e\n\u003ctd\u003eINFO\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eMCP_NIXOS_LOG_FILE\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eWhere to document said failures\u003c/td\u003e\n\u003ctd\u003e(nowhere—your secret is safe)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eMCP_NIXOS_CACHE_DIR\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eWhere to store stuff you'll forget about\u003c/td\u003e\n\u003ctd\u003eOS-specific cache locations*\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eMCP_NIXOS_CACHE_TTL\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eHow long until cache invalidation ruins your day\u003c/td\u003e\n\u003ctd\u003e86400 (24h)\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eMCP_NIXOS_CLEANUP_ORPHANS\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eWhether to kill orphaned MCP processes on startup\u003c/td\u003e\n\u003ctd\u003efalse\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eKEEP_TEST_CACHE\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eKeep test cache directory for debugging (dev-only)\u003c/td\u003e\n\u003ctd\u003efalse\u003c/td\u003e\n\u003c/tr\u003e\n\u003ctr\u003e\n\u003ctd\u003e\u003ccode\u003eELASTICSEARCH_URL\u003c/code\u003e\u003c/td\u003e\n\u003ctd\u003eNixOS Elasticsearch API URL\u003c/td\u003e\n\u003ctd\u003e\u003ca href=\"https://search.nixos.org/backend\"\u003ehttps://search.nixos.org/backend\u003c/a\u003e\u003c/td\u003e\n\u003c/tr\u003e\n\u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003e*Default cache locations (where your gigabytes will quietly disappear to):\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eLinux: \u003ccode\u003e~/.cache/mcp_nixos/\u003c/code\u003e (because ~/.cache wasn't cluttered enough)\u003c/li\u003e\n\u003cli\u003emacOS: \u003ccode\u003e~/Library/Caches/mcp_nixos/\u003c/code\u003e (buried where you'll never look)\u003c/li\u003e\n\u003cli\u003eWindows: \u003ccode\u003e%LOCALAPPDATA%\\mcp_nixos\\Cache\\\u003c/code\u003e (lost in the void of Windows directories)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eFeatures That Might Actually Work\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003e\u003cstrong\u003eNixOS Resources\u003c/strong\u003e: Packages and system options via Elasticsearch API\n\u003cul\u003e\n\u003cli\u003eMultiple channels: unstable (for the brave), stable (for the boring), and specific versions\u003c/li\u003e\n\u003cli\u003eDetailed package metadata that tells you everything except how to make it work\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eHome Manager\u003c/strong\u003e: User configuration options via parsed documentation\n\u003cul\u003e\n\u003cli\u003ePrograms, services, and settings you'll spend weekends configuring\u003c/li\u003e\n\u003cli\u003eHierarchical paths for when you want to get absurdly specific\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003enix-darwin\u003c/strong\u003e: macOS configuration for the \"I use NixOS BTW\" Apple users\n\u003cul\u003e\n\u003cli\u003eSystem defaults, services, and settings Apple never intended you to touch\u003c/li\u003e\n\u003cli\u003eBreak your Mac in new and exciting ways!\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eSmart Caching\u003c/strong\u003e: Because nobody wants to wait for Elasticsearch queries\n\u003cul\u003e\n\u003cli\u003eReduces network requests and improves startup time\u003c/li\u003e\n\u003cli\u003eWorks offline once cached (perfect for your next internet outage)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\u003cstrong\u003eRich Search\u003c/strong\u003e: Find what you need or something close enough\n\u003cul\u003e\n\u003cli\u003eFast in-memory search engine that's surprisingly not terrible\u003c/li\u003e\n\u003cli\u003eRelated options for when you're not quite sure what you're looking for\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eMCP Resources \u0026#x26; Tools: The Power Tools You Didn't Know You Needed\u003c/h2\u003e\n\u003ch3\u003eNixOS: The OS That Makes You Feel Simultaneously Smarter and Dumber\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eResources:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003enixos://package/{name}\u003c/code\u003e - Find that package you're sure exists\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enixos://search/packages/{query}\u003c/code\u003e - Search for packages that might exist\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enixos://search/options/{query}\u003c/code\u003e - Search system options you'll misconfig\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enixos://option/{name}\u003c/code\u003e - Get option info you'll still manage to mess up\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enixos://search/programs/{name}\u003c/code\u003e - Find packages providing programs\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enixos://packages/stats\u003c/code\u003e - Stats to impress your nerd friends\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eTools:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003enixos_search(query, type, channel)\u003c/code\u003e - The search function you'll use most\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enixos_info(name, type, channel)\u003c/code\u003e - Get package or option details\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003enixos_stats(channel)\u003c/code\u003e - Get NixOS statistics nobody asked for\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eChannels:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eunstable\u003c/code\u003e (default) - Living on the edge where nothing is stable, including your sanity\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003estable\u003c/code\u003e (24.11) - For those who prefer their breakage on a schedule\u003c/li\u003e\n\u003cli\u003eOld versions - For when you're feeling nostalgic about earlier failures\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eHome Manager: Because System-Wide Configuration Wasn't Complicated Enough\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eResources:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ehome-manager://search/options/{query}\u003c/code\u003e - Search user config options\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ehome-manager://option/{name}\u003c/code\u003e - Option details you'll screenshot for later\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ehome-manager://options/prefix/{prefix}\u003c/code\u003e - All options under a prefix\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ehome-manager://options/{category}\u003c/code\u003e - Category options (programs, services, etc.)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eTools:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003ehome_manager_search(query)\u003c/code\u003e - Search configuration options\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ehome_manager_info(name)\u003c/code\u003e - Get option details with actual explanation\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ehome_manager_options_by_prefix(option_prefix)\u003c/code\u003e - Get options by prefix\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003ehome_manager_list_options()\u003c/code\u003e - List all option categories when overwhelmed\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003enix-darwin: For Mac Users Who Crave Pain\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eResources:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003edarwin://search/options/{query}\u003c/code\u003e - Search macOS options\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003edarwin://option/{name}\u003c/code\u003e - Option details for your Apple devices\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003edarwin://options/prefix/{prefix}\u003c/code\u003e - All options under a prefix\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003edarwin://options/{category}\u003c/code\u003e - Category options (system, services, etc.)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eTools:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003edarwin_search(query)\u003c/code\u003e - Search macOS configuration options\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003edarwin_info(name)\u003c/code\u003e - Get option details Apple doesn't want you to know\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003edarwin_options_by_prefix(option_prefix)\u003c/code\u003e - Get options by prefix\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003edarwin_list_options()\u003c/code\u003e - List all option categories\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eTool Usage Examples (Copy/Paste Ready)\u003c/h3\u003e\n\u003cpre class=\"language-python\"\u003e\u003ccode class=\"language-python\"\u003e\u003cspan class=\"token comment\"\u003e# NixOS examples for when you're pretending to know what you're doing\u003c/span\u003e\nnixos_search\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"firefox\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003etype\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"packages\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e channel\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"unstable\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nnixos_search\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"postgresql\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003etype\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"options\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e channel\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"stable\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nnixos_info\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ename\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"firefox\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003etype\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"package\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nnixos_info\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ename\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"services.postgresql.enable\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token builtin\"\u003etype\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"option\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# Home Manager examples for the domestic configuration enthusiasts\u003c/span\u003e\nhome_manager_search\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"programs.git\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nhome_manager_info\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ename\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"programs.firefox.enable\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\nhome_manager_options_by_prefix\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eoption_prefix\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"programs.git\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# nix-darwin examples for the masochistic Mac users\u003c/span\u003e\ndarwin_search\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003equery\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"system.defaults.dock\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ndarwin_info\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ename\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"services.yabai.enable\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\ndarwin_options_by_prefix\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eoption_prefix\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"system.defaults\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eInstallation \u0026#x26; Configuration: The Part You'll Probably Skip\u003c/h2\u003e\n\u003ch3\u003eInstall It (Pick Your Poison)\u003c/h3\u003e\n\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token comment\"\u003e# Option 1: Install with pip like a normie\u003c/span\u003e\npip \u003cspan class=\"token function\"\u003einstall\u003c/span\u003e mcp-nixos\n\n\u003cspan class=\"token comment\"\u003e# Option 2: Install with uv because you're too cool for pip\u003c/span\u003e\nuv pip \u003cspan class=\"token function\"\u003einstall\u003c/span\u003e mcp-nixos\n\n\u003cspan class=\"token comment\"\u003e# Option 3: Run directly with uvx (recommended for the truly enlightened)\u003c/span\u003e\nuvx --install-deps mcp-nixos\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eConfigure It (The Part You'll Definitely Mess Up)\u003c/h3\u003e\n\u003cp\u003eAdd to your MCP configuration file (e.g., \u003ccode\u003e~/.config/claude/config.json\u003c/code\u003e):\u003c/p\u003e\n\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"mcpServers\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"nixos\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"command\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"uvx\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"args\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"mcp-nixos\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eFor development with the source code (for those who enjoy punishment):\u003c/p\u003e\n\u003cpre class=\"language-json\"\u003e\u003ccode class=\"language-json\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n  \u003cspan class=\"token property\"\u003e\"mcpServers\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n    \u003cspan class=\"token property\"\u003e\"nixos\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"command\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"uv\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"args\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token string\"\u003e\"run\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"-m\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e\"mcp_nixos.__main__\"\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n      \u003cspan class=\"token property\"\u003e\"env\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e\n        \u003cspan class=\"token property\"\u003e\"PYTHONPATH\"\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e\".\"\u003c/span\u003e\n      \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n  \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eCache \u0026#x26; Channels: Where Magic Happens and Files Disappear\u003c/h3\u003e\n\u003cp\u003e\u003cstrong\u003eCache System:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDefault locations that you'll forget about in 5 minutes\u003c/li\u003e\n\u003cli\u003eStores HTML content, serialized data, and search indices\u003c/li\u003e\n\u003cli\u003eWorks offline once cached (the only feature you'll actually appreciate)\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cstrong\u003eNixOS Channels:\u003c/strong\u003e\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003eunstable\u003c/code\u003e: Latest NixOS unstable (for daredevils)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003estable\u003c/code\u003e: Current stable release (for the risk-averse)\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003e24.11\u003c/code\u003e: Specific version reference (for the historically inclined)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eDevelopment: For Those Not Content With Just Using Things\u003c/h2\u003e\n\u003ch3\u003eDependencies (Because Nothing Stands Alone Anymore)\u003c/h3\u003e\n\u003cp\u003eThis project uses \u003ccode\u003epyproject.toml\u003c/code\u003e because we're not animals.\u003c/p\u003e\n\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token comment\"\u003e# Install development dependencies for the brave\u003c/span\u003e\npip \u003cspan class=\"token function\"\u003einstall\u003c/span\u003e \u003cspan class=\"token parameter variable\"\u003e-e\u003c/span\u003e \u003cspan class=\"token string\"\u003e\".[dev]\"\u003c/span\u003e\n\n\u003cspan class=\"token comment\"\u003e# Or with uv (recommended for the enlightened)\u003c/span\u003e\nuv pip \u003cspan class=\"token function\"\u003einstall\u003c/span\u003e \u003cspan class=\"token parameter variable\"\u003e-e\u003c/span\u003e \u003cspan class=\"token string\"\u003e\".[dev]\"\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eUsing Nix (Of Course There's a Nix Development Environment)\u003c/h3\u003e\n\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token comment\"\u003e# Enter dev shell and see available commands\u003c/span\u003e\nnix develop \u003cspan class=\"token operator\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e menu\n\n\u003cspan class=\"token comment\"\u003e# Common commands for common folk\u003c/span\u003e\nrun         \u003cspan class=\"token comment\"\u003e# Start the server (and your journey into madness)\u003c/span\u003e\nrun-tests   \u003cspan class=\"token comment\"\u003e# Run tests with coverage (expose the flaws)\u003c/span\u003e\nlint        \u003cspan class=\"token comment\"\u003e# Format and lint code (fix the mess you made)\u003c/span\u003e\npublish     \u003cspan class=\"token comment\"\u003e# Build and publish to PyPI (share your pain)\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eTesting (Yes, We Actually Do That)\u003c/h3\u003e\n\u003cp\u003eTests use real Elasticsearch API calls instead of mocks because we're not afraid of the real world:\u003c/p\u003e\n\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token comment\"\u003e# Run tests with coverage (default and recommended)\u003c/span\u003e\nrun-tests\n\n\u003cspan class=\"token comment\"\u003e# Run tests without coverage (for those who prefer blissful ignorance)\u003c/span\u003e\nrun-tests --no-coverage\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eCode coverage is tracked on \u003ca href=\"https://codecov.io/gh/utensils/mcp-nixos\"\u003eCodecov\u003c/a\u003e (where we pretend to care about 100% coverage).\u003c/p\u003e\n\u003ch2\u003eUsing with LLMs: The Whole Point of This Exercise\u003c/h2\u003e\n\u003cp\u003eOnce configured, use MCP-NixOS in your prompts with MCP-compatible models:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e# NixOS resources for the confused\n~nixos://package/python\n~nixos://option/services.nginx\n~nixos://search/packages/firefox\n\n# Home Manager resources for the domestically challenged\n~home-manager://search/options/programs.git\n~home-manager://option/programs.firefox.profiles\n\n# nix-darwin resources for the Apple addicted\n~darwin://search/options/system.defaults.dock\n\n# NixOS tools for the tool-inclined\n~nixos_search(query=\"postgresql\", type=\"options\")\n~nixos_info(name=\"firefox\", type=\"package\", channel=\"unstable\")\n\n# Home Manager tools for home improvement\n~home_manager_search(query=\"programs.zsh\")\n~home_manager_info(name=\"programs.git.userName\")\n\n# nix-darwin tools for the Mac masochists\n~darwin_search(query=\"services.yabai\")\n~darwin_info(name=\"system.defaults.dock.autohide\")\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe LLM will fetch information through the MCP server and might actually give you correct information for once.\u003c/p\u003e\n\u003ch2\u003eImplementation Details: The House of Cards Revealed\u003c/h2\u003e\n\u003ch3\u003eCode Architecture: How We Made This Work (Somehow)\u003c/h3\u003e\n\u003cp\u003eMCP-NixOS is organized into a modular structure that somehow manages to work despite all odds:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ccode\u003emcp_nixos/cache/\u003c/code\u003e - Caching components that save your bandwidth and sanity\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emcp_nixos/clients/\u003c/code\u003e - API clients that talk to Elasticsearch and parse HTML docs\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emcp_nixos/contexts/\u003c/code\u003e - Context objects that keep everything from falling apart\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emcp_nixos/resources/\u003c/code\u003e - MCP resource definitions for all platforms\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emcp_nixos/tools/\u003c/code\u003e - MCP tool implementations that do the actual work\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emcp_nixos/utils/\u003c/code\u003e - Utility functions because we're not animals\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003emcp_nixos/server.py\u003c/code\u003e - The glue that holds this house of cards together\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eNixOS API Integration: The External Connection\u003c/h3\u003e\n\u003cp\u003eConnects to the NixOS Elasticsearch API with:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eMultiple channel support (unstable, stable/24.11)\u003c/li\u003e\n\u003cli\u003eField-specific search boosts for better relevance\u003c/li\u003e\n\u003cli\u003eError handling that expects the worst but hopes for the best (story of my life)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eHTML Documentation Parsers: Where Dreams Go To Die\u003c/h3\u003e\n\u003cp\u003eFor Home Manager and nix-darwin options, we've committed crimes against HTML parsing:\u003c/p\u003e\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eDocumentation Parsers\u003c/strong\u003e: Extracts structured data through a combination of BeautifulSoup incantations, regex black magic, and the kind of determination that only comes from staring at malformed HTML for 72 hours straight.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eSearch Engines\u003c/strong\u003e: Cobbled together with:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eInverted index for fast text search (when it doesn't fall over)\u003c/li\u003e\n\u003cli\u003ePrefix tree for hierarchical lookups (seemed like a good idea at 3 AM)\u003c/li\u003e\n\u003cli\u003eResult scoring based on an algorithm best described as \"vibes-based sorting\"\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eCaching System\u003c/strong\u003e: Because parsing that HTML once was traumatic enough:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eStores HTML content, processed data structures, and search indices\u003c/li\u003e\n\u003cli\u003eUses platform-specific cache locations so you don't have to think about it\u003c/li\u003e\n\u003cli\u003eImplements TTL-based expiration to refresh content when needed\u003c/li\u003e\n\u003cli\u003eFalls back gracefully when things inevitably go wrong (unlike my relationships)\u003c/li\u003e\n\u003c/ul\u003e\n\u003c/li\u003e\n\u003c/ol\u003e\n\u003ch2\u003eWhat is Model Context Protocol?\u003c/h2\u003e\n\u003ch3\u003eFor Those Who Skipped Straight to the End\u003c/h3\u003e\n\u003cp\u003eThe \u003ca href=\"https://modelcontextprotocol.io\"\u003eModel Context Protocol (MCP)\u003c/a\u003e is an open protocol that connects LLMs to external data and tools using JSON messages over stdin/stdout. This project implements MCP to give AI assistants access to NixOS, Home Manager, and nix-darwin resources, so they can finally stop making things up about your operating system.\u003c/p\u003e\n\u003ch2\u003eLicense\u003c/h2\u003e\n\u003cp\u003eMIT (Because I'm not a monster)\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003e\u003cem\u003eCreated by James Brink, self-proclaimed Tinkerer of Terror, who somehow manages to make things work despite himself.\u003c/em\u003e\u003c/p\u003e\n","slug":"mcp-nixos","ogImage":"/images/pages/mcp-nixos/social-share.png"}},"__N_SSG":true},"page":"/[page]","query":{"page":"mcp-nixos"},"buildId":"Um1-lr3K4IXIJU3rT7vNx","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>